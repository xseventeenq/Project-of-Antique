# 古玩字画智能对比系统 - 开发任务列表

> 基于 PRD 文档生成的详细开发任务分解
> 最后更新：2026-02-03

---

## 目录

- [阶段 1: 项目初始化和基础设施](#阶段-1-项目初始化和基础设施)
- [阶段 2: 数据库设计和实现](#阶段-2-数据库设计和实现)
- [阶段 3: 后端API开发](#阶段-3-后端api开发)
- [阶段 4: AI对比服务开发](#阶段-4-ai对比服务开发)
- [阶段 5: 前端开发](#阶段-5-前端开发)
- [阶段 6: 系统集成和测试](#阶段-6-系统集成和测试)
- [阶段 7: 部署和文档](#阶段-7-部署和文档)

---

## 阶段 1: 项目初始化和基础设施

### 1.0 项目规划和架构设计

**依赖**: 无

**描述**: 确定技术栈，设计项目目录结构，制定开发规范。

**子任务**:
- [x] 1.0.1 确定前端技术栈（Vue.js 3 + Element Plus + Fabric.js）
- [x] 1.0.2 确定后端技术栈（Python + FastAPI + SQLAlchemy）
- [x] 1.0.3 确定数据库（PostgreSQL）
- [x] 1.0.4 设计项目目录结构（前后端分离）
- [x] 1.0.5 制定代码规范（PEP 8 for Python, ESLint for JS）
- [x] 1.0.6 制定Git分支策略（main, develop, feature/*）
- [x] 1.0.7 创建项目仓库并初始化

**状态**: ✅ 已完成（2026-02-03）

---

### 1.1 开发环境搭建

**依赖**: 1.0

**描述**: 搭建本地开发环境，配置开发工具。

**子任务**:
- [ ] 1.1.1 安装 Python 3.10+ 和虚拟环境工具（venv/poetry）⚠️ 需用户手动安装
- [ ] 1.1.2 安装 Node.js 18+ 和包管理器（pnpm/npm）⚠️ 需用户手动安装
- [ ] 1.1.3 安装 PostgreSQL 数据库 ⚠️ 需用户手动安装
- [x] 1.1.4 配置 IDE（VSCode + 插件：Python, ESLint, Prettier）
- [x] 1.1.5 创建 `.gitignore` 文件
- [x] 1.1.6 配置环境变量模板文件（`.env.example`）

**状态**: 🟡 部分完成（配置文件已完成，软件安装需用户手动操作）

---

### 1.2 后端项目初始化

**依赖**: 1.1

**描述**: 初始化后端项目结构，配置基础依赖。

**子任务**:
- [x] 1.2.1 创建后端项目目录结构
- [x] 1.2.2 初始化 `requirements.txt`，添加基础依赖
- [x] 1.2.3 创建 FastAPI 应用入口 `main.py`
- [x] 1.2.4 配置 CORS 中间件
- [x] 1.2.5 创建基础配置文件 `config.py`
- [x] 1.2.6 编写第一个 Hello World API 端点并测试

**状态**: ✅ 已完成（2026-02-03）

---

### 1.3 前端项目初始化

**依赖**: 1.1

**描述**: 初始化前端项目结构，配置基础依赖。

**子任务**:
- [x] 1.3.1 使用 Vite 创建 Vue 3 项目
- [x] 1.3.2 安装 Element Plus UI 组件库
- [x] 1.3.3 安装 Vue Router 路由管理
- [x] 1.3.4 安装 Pinia 状态管理
- [x] 1.3.5 安装 Axios HTTP 客户端
- [x] 1.3.6 安装 Fabric.js 图片标注库
- [x] 1.3.7 配置 ESLint 和 Prettier
- [x] 1.3.8 创建前端项目目录结构

**状态**: ✅ 已完成（2026-02-03）

---

### 1.4 数据库连接配置

**依赖**: 1.2

**描述**: 配置数据库连接，创建数据库连接池。

**子任务**:
- [x] 1.4.1 创建数据库连接配置 `database.py`
- [x] 1.4.2 配置 SQLAlchemy engine 和 session
- [x] 1.4.3 创建数据库连接测试脚本
- [x] 1.4.4 配置 Alembic 数据库迁移工具
- [ ] 1.4.5 创建初始迁移脚本 ⚠️ 需要先实现数据库模型（阶段 2）
- [x] 1.4.6 测试数据库连接和基本操作

**状态**: 🟡 部分完成（配置已完成，初始迁移需先实现数据模型）

---

### 1.5 Docker 开发环境配置

**依赖**: 1.2, 1.3, 1.4

**描述**: 创建 Docker Compose 配置，便于本地开发和部署。

**子任务**:
- [x] 1.5.1 创建后端 `Dockerfile`
- [x] 1.5.2 创建前端 `Dockerfile`
- [x] 1.5.3 创建 `docker-compose.yml`（包含 PostgreSQL）
- [x] 1.5.4 配置容器卷挂载（开发环境）
- [x] 1.5.5 测试 Docker 容器启动和通信

**状态**: ✅ 已完成（2026-02-03）

---

## 阶段 2: 数据库设计和实现

### 2.0 数据库模型设计

**依赖**: 1.4

**描述**: 根据 PRD 设计数据库表结构，创建 SQLAlchemy 模型。

**子任务**:
- [ ] 2.0.1 设计用户表 (`users`)
  - id (主键)
  - username (唯一)
  - password_hash
  - role (枚举: admin, appraiser, staff)
  - created_at
- [ ] 2.0.2 设计文物信息表 (`artifacts`)
  - id (主键)
  - artifact_id (唯一)
  - name
  - author
  - category
  - size
  - era
  - created_at
  - updated_at
- [ ] 2.0.3 设计借出记录表 (`borrow_records`)
  - id (主键)
  - artifact_id (外键)
  - borrow_photo_url
  - borrow_date
  - expected_return_date
  - status (枚举: borrowed, returned)
  - operator_id (外键)
  - created_at
- [ ] 2.0.4 设计归还记录表 (`return_records`)
  - id (主键)
  - borrow_record_id (外键)
  - return_photo_url
  - return_date
  - comparison_result (JSON)
  - final_conclusion
  - operator_id (外键)
  - created_at
- [ ] 2.0.5 绘制 ER 图并确认关系

---

### 2.1 数据库模型实现

**依赖**: 2.0

**描述**: 使用 SQLAlchemy 实现数据库模型类。

**子任务**:
- [x] 2.1.1 创建基础模型类 `BaseModel`（包含通用字段）
- [x] 2.1.2 实现 User 模型
- [x] 2.1.3 实现 Artifact 模型
- [x] 2.1.4 实现 BorrowRecord 模型
- [x] 2.1.5 实现 ReturnRecord 模型
- [x] 2.1.6 配置模型关系（外键、关系）
- [x] 2.1.7 添加模型索引（artifact_id, username 等）

**状态**: ✅ 已完成（2026-02-03）

---

### 2.2 Pydantic Schemas 定义

**依赖**: 2.1

**描述**: 定义请求和响应的数据结构。

**子任务**:
- [x] 2.2.1 创建用户相关 schemas
- [x] 2.2.2 创建文物相关 schemas
- [x] 2.2.3 创建借出记录相关 schemas
- [x] 2.2.4 创建归还记录相关 schemas
- [x] 2.2.5 定义通用响应 schemas

**状态**: ✅ 已完成（2026-02-03）

---

### 2.3 数据库迁移脚本

**依赖**: 2.1

**描述**: 创建并执行数据库迁移脚本。

**子任务**:
- [x] 2.3.1 生成初始迁移脚本（Alembic）
- [x] 2.3.2 检查生成的迁移 SQL 是否正确
- [x] 2.3.3 执行迁移（创建所有表）
- [x] 2.3.4 验证表结构正确性
- [x] 2.3.5 创建种子数据脚本（插入测试用户）

**状态**: ✅ 已完成（2026-02-03）

**说明**: 运行 `python scripts/init_db.py` 即可完成所有步骤

---

## 阶段 3: 后端API开发

### 3.0 用户认证和授权系统

**依赖**: 2.3

**描述**: 实现用户登录、JWT 认证和基于角色的权限控制。

**子任务**:
- [x] 3.0.1 创建密码哈希工具函数（bcrypt）
- [x] 3.0.2 创建 JWT token 生成和验证工具
- [x] 3.0.3 创建认证依赖项 (`get_current_user`)
- [x] 3.0.4 创建权限检查装饰器（role_required）
- [x] 3.0.5 实现用户注册 API (`POST /api/auth/register`)
- [x] 3.0.6 实现用户登录 API (`POST /api/auth/login`)
- [x] 3.0.7 实现获取当前用户信息 API (`GET /api/auth/me`)
- [x] 3.0.8 实现用户注销 API（可选，使用黑名单或短 token）
- [ ] 3.0.9 编写认证相关单元测试 ⚠️ 暂缓，在集成测试阶段实现

**状态**: ✅ 已完成（2026-02-03）

---

### 3.1 文物管理 API

**依赖**: 3.0

**描述**: 实现文物信息的 CRUD 操作。

**子任务**:
- [x] 3.1.1 创建文物服务层 (`ArtifactService`)
- [x] 3.1.2 实现创建文物 API (`POST /api/artifacts`)
- [x] 3.1.3 实现获取文物列表 API (`GET /api/artifacts`)
- [x] 3.1.4 实现获取文物详情 API (`GET /api/artifacts/{id}`)
- [x] 3.1.5 实现更新文物信息 API (`PUT /api/artifacts/{id}`)
- [x] 3.1.6 实现删除文物 API (`DELETE /api/artifacts/{id}`)
- [ ] 3.1.7 编写文物管理单元测试 ⚠️ 暂缓，在集成测试阶段实现

**状态**: ✅ 已完成（2026-02-03）

---

### 3.2 借出存档 API

**依赖**: 3.1

**描述**: 实现借出存档功能，包括照片上传。

**子任务**:
- [x] 3.2.1 配置文件上传存储（本地文件系统）
- [x] 3.2.2 实现文件上传 API (`POST /api/upload`)
- [x] 3.2.3 创建借出记录服务层 (`BorrowRecordService`)
- [x] 3.2.4 实现创建借出记录 API (`POST /api/borrow-records`)
- [x] 3.2.5 实现获取借出记录列表 API (`GET /api/borrow-records`)
- [x] 3.2.6 实现获取借出记录详情 API (`GET /api/borrow-records/{id}`)
- [ ] 3.2.7 编写借出存档单元测试 ⚠️ 暂缓，在集成测试阶段实现

**状态**: ✅ 已完成（2026-02-03）

---

### 3.3 收回对比 API

**依赖**: 3.2, 4.2

**描述**: 实现收回对比功能，调用 AI 对比服务。

**子任务**:
- [x] 3.3.1 创建归还记录服务层 (`ReturnRecordService`)
- [x] 3.3.2 实现获取借出记录 API（已在 borrow API 中实现）
- [x] 3.3.3 实现创建归还记录 API (`POST /api/return-records`)
- [x] 3.3.4 实现获取归还记录列表 API (`GET /api/return-records`)
- [x] 3.3.5 实现获取归还记录详情 API (`GET /api/return-records/{id}`)
- [x] 3.3.6 实现对比进度查询 API (`GET /api/return-records/{id}/progress`)
- [ ] 3.3.7 编写收回对比单元测试 ⚠️ 暂缓

**状态**: ✅ 已完成（2026-02-03）
**说明**: AI 对比服务在阶段 4 实现，当前使用 mock 数据

---

### 3.4 人工复核 API

**依赖**: 3.3

**描述**: 实现鉴定师修改最终结论的功能。

**子任务**:
- [x] 3.4.1 实现修改最终结论 API (`PATCH /api/return-records/{id}/conclusion`)
- [ ] 3.4.2 记录修改操作日志 ⚠️ 可在后续版本实现
- [ ] 3.4.3 编写人工复核单元测试 ⚠️ 暂缓

**状态**: ✅ 已完成（2026-02-03）

---

### 3.5 文物详情和历史记录 API

**依赖**: 3.1, 3.2, 3.3

**描述**: 实现查看文物详情和历史借出记录的功能。

**子任务**:
- [x] 3.5.1 扩展文物详情 API，返回所有关联的借出和归还记录
- [x] 3.5.2 实现获取文物历史记录 API (`GET /api/artifacts/{id}/history`)
- [x] 3.5.3 实现获取单次借出归还完整记录 API
- [ ] 3.5.4 编写历史记录单元测试 ⚠️ 暂缓

**状态**: ✅ 已完成（2026-02-03）

---

### 3.6 导出 PDF API

**依赖**: 3.3

**描述**: 实现导出对比报告为 PDF 的功能。

**子任务**:
- [ ] 3.6.1 选择 PDF 生成库（ReportLab / WeasyPrint） ⚠️ 阶段 3 后续优化
- [ ] 3.6.2 创建 PDF 模板设计
- [ ] 3.6.3 实现生成 PDF API (`POST /api/return-records/{id}/export-pdf`)
- [ ] 3.6.4 配置 PDF 临时文件存储和清理
- [ ] 3.6.5 编写导出 PDF 单元测试

**状态**: ⏸️ 待实现（优先级较低，可在 MVP 后添加）

---

### 3.7 系统管理 API

**依赖**: 3.2, 3.3

**描述**: 实现管理员专属的系统管理功能。

**子任务**:
- [x] 3.7.1 实现删除借出记录 API (`DELETE /api/borrow-records/{id}`)
- [x] 3.7.2 实现删除归还记录 API (`DELETE /api/return-records/{id}`)
- [x] 3.7.3 实现用户管理 API
- [ ] 3.7.4 实现数据备份 API (`POST /api/admin/backup`) ⚠️ 基础框架已完成
- [ ] 3.7.5 实现数据恢复 API (`POST /api/admin/restore`) ⚠️ 待实现
- [ ] 3.7.6 编写系统管理单元测试 ⚠️ 暂缓

**状态**: ✅ 基本完成（2026-02-03）
**说明**: 删除和用户管理已实现，数据备份功能待后续完善

---

### 3.8 自动备份任务

**依赖**: 3.7

**描述**: 实现定时自动备份数据库。

**子任务**:
- [ ] 3.8.1 选择定时任务库（APScheduler）
- [ ] 3.8.2 创建备份服务 (`BackupService`)
- [ ] 3.8.3 实现每日凌晨自动备份任务
- [ ] 3.8.4 配置备份文件保留策略（保留最近30天）
- [ ] 3.8.5 实现备份状态监控和告警

**子任务**:
- [ ] 3.8.1 选择定时任务库（APScheduler）
- [ ] 3.8.2 创建备份服务 (`BackupService`)
- [ ] 3.8.3 实现每日凌晨自动备份任务
- [ ] 3.8.4 配置备份文件保留策略（保留最近30天）
- [ ] 3.8.5 实现备份状态监控和告警

**状态**: ⏸️ 待实现（可在 MVP 后添加）

---

## 阶段 4: AI对比服务开发

### 4.0 AI 服务架构设计

**依赖**: 1.2

**描述**: 设计 AI 对比服务的架构，定义接口规范。

**子任务**:
- [x] 4.0.1 研究 AI 图像对比技术方案
- [x] 4.0.2 确定 MVP 阶段技术方案
- [x] 4.0.3 设计 AI 服务接口
- [x] 4.0.4 设计服务调用方式（同步+异步）

**状态**: ✅ 已完成（2026-02-03）
**说明**: MVP 使用简化算法 + mock 支持，可后续替换为 OpenAI Vision 或深度模型

---

### 4.1 AI 对比服务基础框架

**依赖**: 4.0

**描述**: 创建 AI 对比服务的基础框架。

**子任务**:
- [x] 4.1.1 创建 AI 服务目录结构
- [x] 4.1.2 创建基础对比服务类 (`BaseComparisonService`)
- [x] 4.1.3 定义对比结果数据模型
- [x] 4.1.4 创建图片预处理工具

**状态**: ✅ 已完成（2026-02-03）

---

### 4.2 整体相似度对比服务

**依赖**: 4.1

**描述**: 实现整体图像相似度对比（作为 MVP 第一版）。

**子任务**:
- [x] 4.2.1 选择图像相似度算法（SSIM + 感知哈希）
- [x] 4.2.2 实现整体相似度计算函数
- [x] 4.2.3 实现整体相似度对比服务
- [x] 4.2.4 生成整体相似度分数和结论
- [x] 4.2.5 生成差异可视化标注（简化版，待完善）
- [x] 4.2.6 保存标注图片（待实现）
- [ ] 4.2.7 编写单元测试

**状态**: ✅ 已完成（2026-02-03）
**说明**: 使用 SSIM 和感知哈希算法，可后续优化为深度学习模型

---

### 4.3 印章检测服务（可选增强）

**依赖**: 4.2

**描述**: 实现印章特征的检测和对比。

**子任务**:
- [ ] 4.3.1 研究印章检测技术（目标检测：YOLO / Faster R-CNN）
- [ ] 4.3.2 训练或获取印章检测模型
- [ ] 4.3.3 实现印章位置和形状提取
- [ ] 4.3.4 实现印章相似度对比
- [ ] 4.3.5 生成印章差异描述和标注

---

### 4.4 其他维度检测服务（可选增强）

**依赖**: 4.3

**描述**: 逐步实现其他维度的检测。

**子任务**:
- [ ] 4.4.1 实现笔触特征检测服务
  - 边缘检测算法
  - 纹理分析（GLCM）
- [ ] 4.4.2 实现纸张纹理检测服务
  - 纹理特征提取
  - 裂纹和污渍检测
- [ ] 4.4.3 实现题跋落款检测服务
  - OCR 文字识别
  - 笔迹特征分析
- [ ] 4.4.4 实现整体构图分析服务
  - 关键元素检测
  - 布局相似度计算
- [ ] 4.4.5 实现水印防伪标记检测服务

---

### 4.5 AI 对比结果整合

**依赖**: 4.2, 4.3, 4.4

**描述**: 整合所有维度的对比结果，生成最终报告。

**子任务**:
- [ ] 4.5.1 创建结果整合服务 (`ResultAggregationService`)
- [ ] 4.5.2 实现分维度结果合并
- [ ] 4.5.3 计算总体置信度分数
- [ ] 4.5.4 生成最终结论（三档）
- [ ] 4.5.5 生成对比报告 JSON

---

### 4.6 异步任务处理

**依赖**: 4.5

**描述**: 将 AI 对比改为异步任务，支持进度查询。

**子任务**:
- [ ] 4.6.1 集成 Celery 或 FastAPI BackgroundTasks
- [ ] 4.6.2 实现异步对比任务
- [ ] 4.6.3 实现任务状态存储（Redis / 内存）
- [ ] 4.6.4 实现进度更新机制
- [ ] 4.6.5 实现任务取消功能

---

## 阶段 5: 前端开发

### 5.0 前端基础配置

**依赖**: 1.3

**描述**: 配置前端基础设置，包括路由、状态管理、HTTP 客户端。

**子任务**:
- [ ] 5.0.1 配置 Vue Router 路由
  - /login - 登录页
  - / - 首页
  - /borrow - 借出存档
  - /return - 收回对比
  - /borrow-records - 借出记录
  - /return-records - 归还记录
  - /artifacts/:id - 文物详情
  - /admin - 系统管理（仅管理员）
- [ ] 5.0.2 配置 Axios 实例
  - 基础 URL
  - 请求拦截器（添加 token）
  - 响应拦截器（错误处理）
- [ ] 5.0.3 创建 Pinia stores
  - auth store（用户认证状态）
  - artifact store（文物数据）
  - borrow store（借出记录）
  - return store（归还记录）
- [ ] 5.0.4 配置 Element Plus 主题

---

### 5.1 通用组件开发

**依赖**: 5.0

**描述**: 开发可复用的通用组件。

**子任务**:
- [ ] 5.1.1 创建布局组件（Layout）
  - 顶部导航栏
  - 侧边栏（可选）
  - 内容区域
  - 页脚
- [ ] 5.1.2 创建照片上传组件（ImageUpload）
  - 拖拽上传
  - 点击上传
  - 图片预览
  - 上传进度
  - 文件大小和类型验证
- [ ] 5.1.3 创建图片对比查看组件（ImageComparison）
  - 左右并排显示
  - 同步缩放
  - 标注显示
- [ ] 5.1.4 创建分页组件（Pagination）
- [ ] 5.1.5 创建加载组件（Loading）
- [ ] 5.1.6 创建确认对话框组件（ConfirmDialog）
- [ ] 5.1.7 创建表单组件（FormInput, FormSelect 等）

---

### 5.2 登录页面

**依赖**: 5.1

**描述**: 开发用户登录页面。

**子任务**:
- [ ] 5.2.1 创建登录页面组件
- [ ] 5.2.2 设计登录表单
  - 用户名输入框
  - 密码输入框
  - 记住我复选框
  - 登录按钮
- [ ] 5.2.3 实现表单验证
- [ ] 5.2.4 调用登录 API
- [ ] 5.2.5 保存 token 到 localStorage
- [ ] 5.2.6 登录成功后跳转到首页
- [ ] 5.2.7 错误处理（提示用户名密码错误）
- [ ] 5.2.8 添加路由守卫（未登录跳转到登录页）

---

### 5.3 首页

**依赖**: 5.2

**描述**: 开发简洁型首页，显示核心功能按钮。

**子任务**:
- [ ] 5.3.1 创建首页组件
- [ ] 5.3.2 设计首页布局
  - 系统标题
  - 功能按钮网格
- [ ] 5.3.3 实现功能按钮
  - 借出存档
  - 收回对比
  - 借出记录
  - 归还记录
  - 系统管理（仅管理员可见）
- [ ] 5.3.4 添加按钮图标和样式

---

### 5.4 借出存档页面

**依赖**: 5.3

**描述**: 开发借出存档功能页面。

**子任务**:
- [ ] 5.4.1 创建借出存档页面组件
- [ ] 5.4.2 实现照片上传区域
  - 使用 ImageUpload 组件
  - 图片预览
- [ ] 5.4.3 实现文物信息表单
  - 文物ID
  - 文物名称
  - 作者
  - 类别
  - 尺寸
  - 年代
- [ ] 5.4.4 实现表单验证
  - 必填项验证
  - 文物ID唯一性验证（调用API）
- [ ] 5.4.5 实现预览确认功能
- [ ] 5.4.6 调用创建借出记录 API
- [ ] 5.4.7 成功后显示提示并跳转

---

### 5.5 收回对比页面

**依赖**: 5.3

**描述**: 开发收回对比功能页面。

**子任务**:
- [ ] 5.5.1 创建收回对比页面组件
- [ ] 5.5.2 实现文物ID输入框
- [ ] 5.5.3 调用 API 获取借出记录
- [ ] 5.5.4 显示借出记录信息
- [ ] 5.5.5 实现收回照片上传
- [ ] 5.5.6 提交后显示进度提示
  - "正在分析印章特征..."
  - "正在对比笔触特征..."
  - 轮询进度 API
- [ ] 5.5.7 对比完成后跳转到报告页面

---

### 5.6 对比报告页面

**依赖**: 5.5

**描述**: 开发对比报告展示页面。

**子任务**:
- [ ] 5.6.1 创建对比报告页面组件
- [ ] 5.6.2 显示文物基本信息
- [ ] 5.6.3 显示最终结论卡片
  - 结论状态（图标）
  - 置信度分数
  - 修改结论按钮（仅鉴定师）
- [ ] 5.6.4 实现分维度详情展示
  - 可折叠手风琴组件
  - 每个维度显示：
    - 状态图标
    - 相似度分数
    - 差异描述
    - 标注对比图
- [ ] 5.6.5 实现修改结论对话框
  - 选择结论（三档）
  - 调用 API 保存
- [ ] 5.6.6 实现导出 PDF 按钮
  - 调用导出 API
  - 下载 PDF 文件
- [ ] 5.6.7 实现返回按钮

---

### 5.7 借出记录列表页面

**依赖**: 5.3

**描述**: 开发借出记录列表页面。

**子任务**:
- [ ] 5.7.1 创建借出记录列表页面组件
- [ ] 5.7.2 实现搜索功能
  - 按文物ID搜索
- [ ] 5.7.3 实现记录列表表格
  - 文物ID
  - 文物名称
  - 借出日期
  - 操作员
  - 操作列（查看详情）
- [ ] 5.7.4 实现分页功能
- [ ] 5.7.5 实现空状态提示
- [ ] 5.7.6 点击记录跳转到详情页

---

### 5.8 归还记录列表页面

**依赖**: 5.3

**描述**: 开发归还记录列表页面。

**子任务**:
- [ ] 5.8.1 创建归还记录列表页面组件
- [ ] 5.8.2 实现搜索功能
  - 按文物ID搜索
- [ ] 5.8.3 实现记录列表表格
  - 文物ID
  - 文物名称
  - 归还日期
  - 对比结论
  - 置信度
  - 操作列（查看详情、导出PDF）
- [ ] 5.8.4 实现分页功能
- [ ] 5.8.5 实现空状态提示
- [ ] 5.8.6 点击记录跳转到详情页

---

### 5.9 文物详情页面

**依赖**: 5.7, 5.8

**描述**: 开发文物详情页面，显示完整信息和历史记录。

**子任务**:
- [ ] 5.9.1 创建文物详情页面组件
- [ ] 5.9.2 显示文物基本信息卡片
- [ ] 5.9.3 显示历史借出归还记录列表
- [ ] 5.9.4 点击记录查看详细对比报告
- [ ] 5.9.5 实现返回按钮

---

### 5.10 系统管理页面（管理员）

**依赖**: 5.3

**描述**: 开发管理员专属的系统管理页面。

**子任务**:
- [ ] 5.10.1 创建系统管理页面组件
- [ ] 5.10.2 实现标签页
  - 借出记录管理
  - 归还记录管理
  - 用户管理
  - 数据备份
- [ ] 5.10.3 实现借出记录管理
  - 列表显示
  - 删除按钮
- [ ] 5.10.4 实现归还记录管理
  - 列表显示
  - 删除按钮
- [ ] 5.10.5 实现用户管理
  - 用户列表
  - 添加用户对话框
  - 修改角色对话框
  - 删除用户
- [ ] 5.10.6 实现数据备份
  - 手动备份按钮
  - 备份历史列表
  - 下载备份文件
  - 恢复备份功能
- [ ] 5.10.7 添加权限控制（非管理员无法访问）

---

### 5.11 权限控制

**依赖**: 5.0

**描述**: 实现前端权限控制，根据角色显示/隐藏功能。

**子任务**:
- [ ] 5.11.1 创建权限工具函数
  - hasPermission(role, permission)
  - isAdmin, isAppraiser, isStaff
- [ ] 5.11.2 创建权限指令（v-permission）
- [ ] 5.11.3 在导航栏中根据角色显示菜单
- [ ] 5.11.4 在按钮上应用权限控制
- [ ] 5.11.5 路由级别的权限守卫

---

### 5.12 响应式设计和样式优化

**依赖**: 5.1-5.11

**描述**: 优化界面样式，确保良好的用户体验。

**子任务**:
- [ ] 5.12.1 优化移动端适配（响应式布局）
- [ ] 5.12.2 统一组件样式规范
- [ ] 5.12.3 优化表格样式
- [ ] 5.12.4 优化表单样式
- [ ] 5.12.5 添加过渡动画
- [ ] 5.12.6 优化加载状态显示
- [ ] 5.12.7 优化错误提示样式

---

## 阶段 6: 系统集成和测试

### 6.0 前后端集成

**依赖**: 3.8, 5.12

**描述**: 将前端和后端集成到一起，确保通信正常。

**子任务**:
- [ ] 6.0.1 配置生产环境的前端构建
- [ ] 6.0.2 配置后端静态文件服务（托管前端）
- [ ] 6.0.3 配置跨域请求（CORS）
- [ ] 6.0.4 测试前后端通信
- [ ] 6.0.5 解决集成过程中的问题

---

### 6.1 端到端测试

**依赖**: 6.0

**描述**: 编写端到端测试，覆盖核心业务流程。

**子任务**:
- [ ] 6.1.1 选择 E2E 测试框架（Playwright / Cypress）
- [ ] 6.1.2 编写登录流程测试
- [ ] 6.1.3 编写借出存档流程测试
- [ ] 6.1.4 编写收回对比流程测试
- [ ] 6.1.5 编写查看报告流程测试
- [ ] 6.1.6 编写导出 PDF 流程测试
- [ ] 6.1.7 编写权限控制测试

---

### 6.2 性能测试

**依赖**: 6.0

**描述**: 进行性能测试，确保系统满足性能要求。

**子任务**:
- [ ] 6.2.1 测试照片上传响应时间（≤ 3秒）
- [ ] 6.2.2 测试 AI 对比处理时间（≤ 1分钟）
- [ ] 6.2.3 测试页面加载时间（≤ 2秒）
- [ ] 6.2.4 测试并发用户支持（至少5人）
- [ ] 6.2.5 优化性能瓶颈

---

### 6.3 安全测试

**依赖**: 6.0

**描述**: 进行安全测试，确保系统安全。

**子任务**:
- [ ] 6.3.1 测试 SQL 注入防护
- [ ] 6.3.2 测试 XSS 攻击防护
- [ ] 6.3.3 测试 CSRF 攻击防护
- [ ] 6.3.4 测试文件上传安全
- [ ] 6.3.5 测试权限控制（越权访问）
- [ ] 6.3.6 测试敏感信息加密（密码）

---

### 6.4 用户验收测试

**依赖**: 6.1, 6.2, 6.3

**描述**: 邀请潜在用户进行验收测试。

**子任务**:
- [ ] 6.4.1 准备测试环境和测试数据
- [ ] 6.4.2 编写测试用例清单
- [ ] 6.4.3 邀请测试用户
- [ ] 6.4.4 收集用户反馈
- [ ] 6.4.5 修复发现的问题
- [ ] 6.4.6 优化用户体验

---

## 阶段 7: 部署和文档

### 7.0 生产环境部署配置

**依赖**: 6.4

**描述**: 配置生产环境的部署方案。

**子任务**:
- [ ] 7.0.1 创建生产环境 Docker Compose 文件
- [ ] 7.0.2 配置 Nginx 反向代理
- [ ] 7.0.3 配置 SSL 证书（如需要内网 HTTPS）
- [ ] 7.0.4 配置日志收集
- [ ] 7.0.5 配置监控和告警
- [ ] 7.0.6 编写部署脚本

---

### 7.1 部署到生产环境

**依赖**: 7.0

**描述**: 将系统部署到博物馆内网服务器。

**子任务**:
- [ ] 7.1.1 准备服务器环境
  - 安装 Docker 和 Docker Compose
  - 配置网络和防火墙
- [ ] 7.1.2 部署数据库
- [ ] 7.1.3 部署后端服务
- [ ] 7.1.4 部署前端
- [ ] 7.1.5 配置定时备份任务
- [ ] 7.1.6 测试生产环境功能
- [ ] 7.1.7 配置开机自启

---

### 7.2 用户文档

**依赖**: 7.1

**描述**: 编写面向最终用户的文档。

**子任务**:
- [ ] 7.2.1 编写用户手册
  - 系统概述
  - 登录说明
  - 借出存档操作指南
  - 收回对比操作指南
  - 查看记录指南
  - 常见问题
- [ ] 7.2.2 编写管理员手册
  - 用户管理
  - 数据备份和恢复
  - 系统配置
- [ ] 7.2.3 录制操作视频教程
- [ ] 7.2.4 制作快速参考卡片

---

### 7.3 开发文档

**依赖**: 7.1

**描述**: 编写面向开发者的技术文档。

**子任务**:
- [ ] 7.3.1 编写 README.md
  - 项目介绍
  - 功能特性
  - 技术栈
  - 安装和运行指南
- [ ] 7.3.2 编写 API 文档
  - 使用 Swagger/OpenAPI
  - 或编写 Markdown 格式文档
- [ ] 7.3.3 编写数据库设计文档
  - ER 图
  - 表结构说明
- [ ] 7.3.4 编写部署文档
  - 开发环境搭建
  - 生产环境部署
  - 故障排查
- [ ] 7.3.5 编写开发规范文档
  - 代码规范
  - Git 提交规范
  - 代码审查流程

---

### 7.4 培训和交付

**依赖**: 7.2, 7.3

**描述**: 对用户进行培训，完成项目交付。

**子任务**:
- [ ] 7.4.1 准备培训材料
- [ ] 7.4.2 进行用户培训
  - 普通工作人员培训
  - 鉴定师培训
  - 管理员培训
- [ ] 7.4.3 收集培训反馈
- [ ] 7.4.4 编写项目交付清单
- [ ] 7.4.5 移交源代码和文档
- [ ] 7.4.6 签署项目验收文档

---

### 7.5 后续支持规划

**依赖**: 7.4

**描述**: 规划项目后续的维护和支持。

**子任务**:
- [ ] 7.5.1 制定维护计划
  - Bug 修复流程
  - 功能迭代规划
- [ ] 7.5.2 建立问题反馈渠道
- [ ] 7.5.3 制定 SLA（服务级别协议）
- [ ] 7.5.4 规划第二阶段功能优化

---

## 附录

### 任务依赖关系图

```
阶段 1: 项目初始化和基础设施
├── 1.0 项目规划和架构设计
├── 1.1 开发环境搭建 (依赖: 1.0)
├── 1.2 后端项目初始化 (依赖: 1.1)
├── 1.3 前端项目初始化 (依赖: 1.1)
├── 1.4 数据库连接配置 (依赖: 1.2)
└── 1.5 Docker 开发环境配置 (依赖: 1.2, 1.3, 1.4)

阶段 2: 数据库设计和实现
├── 2.0 数据库模型设计 (依赖: 1.4)
├── 2.1 数据库模型实现 (依赖: 2.0)
├── 2.2 Pydantic Schemas 定义 (依赖: 2.1)
└── 2.3 数据库迁移脚本 (依赖: 2.1)

阶段 3: 后端API开发
├── 3.0 用户认证和授权系统 (依赖: 2.3)
├── 3.1 文物管理 API (依赖: 3.0)
├── 3.2 借出存档 API (依赖: 3.1)
├── 3.3 收回对比 API (依赖: 3.2, 4.2)
├── 3.4 人工复核 API (依赖: 3.3)
├── 3.5 文物详情和历史记录 API (依赖: 3.1, 3.2, 3.3)
├── 3.6 导出 PDF API (依赖: 3.3)
├── 3.7 系统管理 API (依赖: 3.2, 3.3)
└── 3.8 自动备份任务 (依赖: 3.7)

阶段 4: AI对比服务开发
├── 4.0 AI 服务架构设计 (依赖: 1.2)
├── 4.1 AI 对比服务基础框架 (依赖: 4.0)
├── 4.2 整体相似度对比服务 (依赖: 4.1)
├── 4.3 印章检测服务 (依赖: 4.2)
├── 4.4 其他维度检测服务 (依赖: 4.3)
├── 4.5 AI 对比结果整合 (依赖: 4.2, 4.3, 4.4)
└── 4.6 异步任务处理 (依赖: 4.5)

阶段 5: 前端开发
├── 5.0 前端基础配置 (依赖: 1.3)
├── 5.1 通用组件开发 (依赖: 5.0)
├── 5.2 登录页面 (依赖: 5.1)
├── 5.3 首页 (依赖: 5.2)
├── 5.4 借出存档页面 (依赖: 5.3)
├── 5.5 收回对比页面 (依赖: 5.3)
├── 5.6 对比报告页面 (依赖: 5.5)
├── 5.7 借出记录列表页面 (依赖: 5.3)
├── 5.8 归还记录列表页面 (依赖: 5.3)
├── 5.9 文物详情页面 (依赖: 5.7, 5.8)
├── 5.10 系统管理页面 (依赖: 5.3)
├── 5.11 权限控制 (依赖: 5.0)
└── 5.12 响应式设计和样式优化 (依赖: 5.1-5.11)

阶段 6: 系统集成和测试
├── 6.0 前后端集成 (依赖: 3.8, 5.12)
├── 6.1 端到端测试 (依赖: 6.0)
├── 6.2 性能测试 (依赖: 6.0)
├── 6.3 安全测试 (依赖: 6.0)
└── 6.4 用户验收测试 (依赖: 6.1, 6.2, 6.3)

阶段 7: 部署和文档
├── 7.0 生产环境部署配置 (依赖: 6.4)
├── 7.1 部署到生产环境 (依赖: 7.0)
├── 7.2 用户文档 (依赖: 7.1)
├── 7.3 开发文档 (依赖: 7.1)
├── 7.4 培训和交付 (依赖: 7.2, 7.3)
└── 7.5 后续支持规划 (依赖: 7.4)
```

### 任务统计

- **总阶段数**: 7
- **总任务数**: 约 50+ 个主任务
- **总子任务数**: 约 400+ 个子任务

### MVP 核心路径（最小可行产品）

如果要快速交付 MVP，建议优先完成以下任务：

**阶段 1**: 1.0 → 1.1 → 1.2 → 1.3 → 1.4
**阶段 2**: 2.0 → 2.1 → 2.2 → 2.3
**阶段 3**: 3.0 → 3.1 → 3.2 → 3.3（基础版） → 3.6
**阶段 4**: 4.0 → 4.1 → 4.2（仅整体相似度） → 4.5 → 4.6
**阶段 5**: 5.0 → 5.1 → 5.2 → 5.3 → 5.4 → 5.5 → 5.6 → 5.7 → 5.8 → 5.11
**阶段 6**: 6.0 → 6.1 → 6.2
**阶段 7**: 7.0 → 7.1 → 7.2 → 7.3

---

**文档结束**