# 开发环境搭建指南

> 古玩字画智能对比系统
> 最后更新：2026-02-03

---

## 目录

- [1. 必需软件安装](#1-必需软件安装)
- [2. 后端环境配置](#2-后端环境配置)
- [3. 前端环境配置](#3-前端环境配置)
- [4. 数据库配置](#4-数据库配置)
- [5. 开发环境启动](#5-开发环境启动)
- [6. 常见问题](#6-常见问题)

---

## 1. 必需软件安装

### 1.1 安装 Python 3.10+

**Windows**:
1. 访问 [Python 官网](https://www.python.org/downloads/)
2. 下载 Python 3.10 或更高版本
3. 安装时勾选 "Add Python to PATH"
4. 验证安装：
   ```bash
   python --version
   # 或
   python3 --version
   ```

**macOS**:
```bash
# 使用 Homebrew
brew install python@3.10
```

**Linux**:
```bash
sudo apt update
sudo apt install python3.10 python3.10-venv
```

### 1.2 安装 Node.js 18+

**Windows/macOS/Linux**:
1. 访问 [Node.js 官网](https://nodejs.org/)
2. 下载 LTS 版本（推荐 18.x 或 20.x）
3. 验证安装：
   ```bash
   node --version
   npm --version
   ```

**推荐使用 pnpm**（更快，节省空间）:
```bash
npm install -g pnpm
```

### 1.3 安装 Git

**Windows**: 下载 [Git for Windows](https://git-scm.com/download/win)

**macOS**:
```bash
brew install git
```

**Linux**:
```bash
sudo apt install git
```

### 1.4 安装 VSCode

1. 访问 [VSCode 官网](https://code.visualstudio.com/)
2. 下载并安装
3. 安装推荐扩展：
   - 打开项目后，VSCode 会提示安装推荐扩展
   - 或按 `Ctrl+Shift+X` 搜索扩展名称安装

---

## 2. 后端环境配置

### 2.1 创建 Python 虚拟环境

```bash
# 进入后端目录
cd backend

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate

# macOS/Linux:
source venv/bin/activate
```

### 2.2 安装 Python 依赖

```bash
# 确保虚拟环境已激活
pip install --upgrade pip

# 安装依赖
pip install -r requirements.txt
```

### 2.3 配置环境变量

```bash
# 返回项目根目录
cd ..

# 复制环境变量模板
cp .env.example .env

# 编辑 .env 文件，配置数据库信息等
```

---

## 3. 前端环境配置

### 3.1 安装依赖

```bash
# 进入前端目录
cd frontend

# 使用 npm
npm install

# 或使用 pnpm（推荐）
pnpm install
```

### 3.2 配置前端环境

前端会自动读取根目录的 `.env` 文件，无需额外配置。

---

## 4. 数据库配置

### 4.1 安装 PostgreSQL 15+

**Windows**:
1. 访问 [PostgreSQL 官网](https://www.postgresql.org/download/windows/)
2. 下载安装程序
3. 安装时记住设置的密码

**macOS**:
```bash
brew install postgresql@15
brew services start postgresql@15
```

**Linux**:
```bash
sudo apt install postgresql-15 postgresql-contrib-15
sudo systemctl start postgresql
```

### 4.2 创建数据库

```bash
# 连接到 PostgreSQL
psql -U postgres

# 创建数据库
CREATE DATABASE antique_comparison;

# 创建用户（可选）
CREATE USER antique_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE antique_comparison TO antique_user;

# 退出
\q
```

### 4.3 配置数据库连接

编辑项目根目录的 `.env` 文件：

```env
DB_HOST=localhost
DB_PORT=5432
DB_NAME=antique_comparison
DB_USER=postgres
DB_PASSWORD=your_password_here
```

---

## 5. 开发环境启动

### 5.1 启动后端服务

```bash
# 进入后端目录
cd backend

# 激活虚拟环境
# Windows:
venv\Scripts\activate

# macOS/Linux:
source venv/bin/activate

# 运行数据库迁移
alembic upgrade head

# 启动开发服务器
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

后端将在 http://localhost:8000 启动

- API 文档: http://localhost:8000/docs
- ReDoc 文档: http://localhost:8000/redoc

### 5.2 启动前端服务

```bash
# 新开一个终端，进入前端目录
cd frontend

# 启动开发服务器
npm run dev
# 或
pnpm dev
```

前端将在 http://localhost:5173 启动

---

## 6. 常见问题

### 6.1 Python 相关问题

**问题**: `python` 命令找不到
**解决**:
- Windows: 重新安装 Python，勾选 "Add to PATH"
- 或使用 `python3` 命令

**问题**: pip 安装依赖很慢
**解决**: 使用国内镜像
```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 6.2 Node.js 相关问题

**问题**: npm 安装依赖很慢
**解决**: 使用国内镜像
```bash
npm config set registry https://registry.npmmirror.com
```

**问题**: `node-sass` 安装失败
**解决**: 本项目已不使用 `node-sass`，如有问题请删除 `node_modules` 重新安装

### 6.3 数据库相关问题

**问题**: 连接数据库失败
**解决**:
1. 检查 PostgreSQL 服务是否启动
2. 检查 `.env` 文件中的数据库配置
3. 检查数据库是否已创建

### 6.4 端口被占用

**问题**: `8000` 或 `5173` 端口已被占用
**解决**:

**Windows**:
```bash
# 查找占用端口的进程
netstat -ano | findstr :8000
# 结束进程
taskkill /PID <进程ID> /F
```

**macOS/Linux**:
```bash
# 查找占用端口的进程
lsof -i :8000
# 结束进程
kill -9 <进程ID>
```

或在 `.env` 文件中更改端口号。

---

## 7. Docker 环境（可选）

如果使用 Docker，可以跳过上述大部分配置：

```bash
# 启动所有服务
docker-compose up -d

# 查看日志
docker-compose logs -f

# 停止服务
docker-compose down
```

---

## 8. IDE 配置

### 8.1 VSCode 推荐扩展

打开项目后，VSCode 会提示安装以下扩展：

- **Python 开发**: Python, Pylance, Black Formatter
- **Vue 开发**: Vue - Official, TypeScript Vue Plugin
- **代码质量**: ESLint, Prettier
- **工具**: GitLens, Material Icon Theme

### 8.2 VSCode 调试配置

项目已包含 `.vscode/launch.json`，可以直接使用调试功能：

1. 按 `F5` 或点击调试面板
2. 选择要启动的服务：
   - `Python: FastAPI Backend`
   - `Vue: Frontend Dev Server`

---

**下一步**: 查看 [技术栈和架构设计](./技术栈和架构设计.md) 了解项目结构
